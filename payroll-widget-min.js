import{checkDisabledBtn as e,createList as t,createListCurrency as l,createSalaryTemplate as r,filterList as a,commaSeprateVal as n}from"https://cdn.jsdelivr.net/gh/thvishal/sk/widget-helper-min.js";let currencyList=[{label:"USD",value:"USD"},{label:"GBP",value:"GBP"},{label:"EUR",value:"EUR"},],url="https://cost-calculator.skuad.io/cost-calculator/active-country-list?enabled=true",fetchCountryData=async e=>{let t=await fetch(e),l=await t.json(),r=l.data.filter(e=>e.label&&e.enabled);return r},countryList=await fetchCountryData("https://cost-calculator.skuad.io/cost-calculator/active-country-list?enabled=true"),countryListWithCurrency=countryList;t(currencyList,"currency-list"),l(currencyList,"currency-input");let baseUrl="https://cost-calculator.skuad.io/cost-calculator/cost",endpoint="https://cost-calculator.skuad.io/cost-calculator/cost?client=website&countryCode=:countryCode&currencyCode=:currencyCode&salary=:salary&isExpat=:isExpat&provinceCode=:provinceCode",countryDownArrow=document.getElementById("show-calc-country"),form=document.getElementById("form"),countryInput=document.getElementById("country-input");countryInput.value="Loading...",countryInput.setAttribute("disabled","");let currencyInput=document.getElementById("currency-input"),currencyListEl=document.getElementById("currency-list"),countryListEl=document.getElementById("country-list"),grossSalaryInput=document.getElementById("gross-salary-input"),getCountryForError=document.querySelector(".error-msg-heading"),calculateBtn=document.getElementById("calculate-salary");grossSalaryInput.value=5e4;let currencyCurSelect=(e,t)=>{let r=countryListWithCurrency.find(t=>t.label===e);if(!r)return;let a=currencyList.filter((e,t)=>e.value!==r.currValue&&t<3),n=currencyList.find(e=>e.value===r.currValue);if(n&&!t){l(currencyList=currencyList.slice(0,3),"currency-input");return}(currencyList=a).push({label:r.currValue,value:r.currValue}),l(currencyList,"currency-input")};fetch("https://api.geoapify.com/v1/ipinfo?&apiKey=c23115da6cf642e59b96f32b9d512a4c",{crossDomain:!0,headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},method:"GET"}).then(e=>e.json()).then(e=>{countryInput.value="",currencyList.push({label:"",value:""})}).catch().finally(()=>{let e=document.getElementById("current-country-new");document.getElementById("c-country-name").innerText=e.innerText,document.getElementById("current-country-2").innerText=e.innerText,"UAE"===e.innerText?e.innerText="United Arab Emirates":("USA"===e.innerText||"United States"===e.innerText)&&(e.innerText="United States of America");let t=countryList.find(t=>t.label===e.innerText);t.label===e.innerText&&(countryInput.removeAttribute("disabled"),countryInput.value=t.label,currencyCurSelect(t.label)),_handleSubmit()});let toggleMonthYear=document.getElementById("switchMonthly"),yearlyRadio=document.getElementById("switchYearly"),comData=null,salaryData=(e="monthly")=>{let t=comData[e];if(!t)return;let l=comData.categories,a=l.map(t=>{let l=t.subCategories.filter(t=>t.localAmounts[`${e}Value`]&&t.visibility).map(t=>({...t,value:t.localAmounts[`${e}Value`]}));return{...t,value:t.localAmounts[`${e}Value`],subCategories:l,categoryKey:t.key,currency:comData.currency}}),n=a.filter(e=>e.visibility&&e.value),c=n.filter(e=>e.categoryKey.includes("employer")||"skuadFee"===e.categoryKey||"skuadFeeDiscount"===e.categoryKey),o=n.filter(e=>e.categoryKey.includes("employee")),s=n.find(e=>"grossSalary"===e.categoryKey),u=[{label:"monthly"===e?"Monthly":"Annually",data:c,grossSalaryTitle:`Gross ${"yearly"===e?"annual":"monthly"} pay`,totalEmploymentCost:comData.totalEmploymentCost.localAmounts[`${e}Value`],currency:comData.currency,grossSalary:s.localAmounts[`${e}Value`],durationHeading:`Total ${"yearly"===e?"annual":"monthly"} cost of employment`},{label:"Amount employee gets",data:o,grossSalaryTitle:`Gross ${"yearly"===e?"annual":"monthly"} pay`,totalEmploymentCost:comData.totalEmployeeSalary.localAmounts[`${e}Value`],currency:comData.currency,grossSalary:s.localAmounts[`${e}Value`],durationHeading:`Net ${"yearly"===e?"annual":"monthly"} salary`},];r(u)};function showModalHandler(){document.getElementById("show-calculator-modal").style.display="block"}grossSalaryInput.addEventListener("keyup",t=>{grossSalaryInput.value=n(grossSalaryInput.value),e()});let _handleSubmit=async e=>{JSON.parse(localStorage.getItem("salaryPopup")),e&&e.preventDefault(),calculateBtn.setAttribute("disabled","");let t=countryList.find(e=>e.label===countryInput.value);if(!t)return;let l=currencyList.find(e=>e.label===currencyInput.value),r=await fetch("https://cost-calculator.skuad.io/cost-calculator/cost?client=website&countryCode=:countryCode&currencyCode=:currencyCode&salary=:salary&isExpat=:isExpat&provinceCode=:provinceCode".replace(":countryCode",t.value).replace(":salary",grossSalaryInput.value.replaceAll(",","")).replace(":currencyCode",l.value));r.json().then(e=>{e.success?(comData=e.data,getCountryForError.innerText=`Want a detailed breakdown for cost of employment in ${t.label}`,document.getElementById("err-msg").style.display="none",comData.currency=l.value,salaryData(),showModalHandler(),document.getElementById("input-amt").innerText=n(grossSalaryInput.value),document.getElementById("c-country-name").innerText=t.label,document.getElementById("current-country-2").innerText=t.label,document.getElementById("salary-wedget-loading").style.display="none"):(document.getElementById("err-msg").style.display="block",document.getElementById("show-calculator-modal").style.display="none",getCountryForError.innerText=`Want a detailed breakdown for cost of employment in ${countryInput.value}`),document.getElementById("calculate-salary").removeAttribute("disabled"),document.getElementById("calculate-salary").innerText="Calculate",document.getElementById("calc-selected-country").innerText="Estimated gross annual salary"}).catch(e=>{document.getElementById("calculate-salary").removeAttribute("disabled"),document.getElementById("calculate-salary").innerText="Calculate"})};form.onsubmit=_handleSubmit,toggleMonthYear.addEventListener("change",e=>{e.target.checked&&salaryData("monthly")}),yearlyRadio.addEventListener("change",e=>{e.target.checked&&salaryData("yearly")});let toggleCountryList=t=>{if(t){t.stopPropagation(),t.target.value&&(t.target.value="");countryListEl.classList.toggle("list-modal"),currencyListEl.classList.add("list-modal"),a(countryList,"","country-list"),e()}else countryListEl.classList.remove("list-modal")};countryDownArrow.addEventListener("click",toggleCountryList),countryInput.addEventListener("click",toggleCountryList),countryInput.addEventListener("blur",e=>{let t=e.target.value,l=countryList.find(e=>e.label.toLowerCase()===t.toLowerCase());l||(countryInput.value="")});let countryListElOnClick=t=>{t.preventDefault(),"Item not found"!==t.target.innerText&&"UL"!==t.target.nodeName&&(countryInput.value=t.target.innerText,currencyCurSelect(t.target.innerText),toggleCountryList(t),l(currencyList,"currency-input"),e())};countryListEl.addEventListener("click",countryListElOnClick),countryInput.addEventListener("input",e=>{let t=e.target.value;a(countryList,t,"country-list"),toggleCountryList()}),document.body.addEventListener("click",()=>{let e=document.querySelectorAll(".list-cotainer");e.forEach(e=>e.classList.add("list-modal"))}),countryInput.addEventListener("keydown",e=>{let t=e.key,l=countryListEl.querySelector(".active");if("ArrowDown"===t){let r=countryListEl.firstChild;if("Item not found"===r.innerText)return;if(l){let a=l.nextSibling;l.classList.remove("active"),a.classList.add("active")}else r.classList.add("active");l.scrollIntoView({block:"center"})}else if("ArrowUp"===t){let n=countryListEl.lastChild;if(l){let c=l.previousSibling;l.classList.remove("active"),c.classList.add("active")}else n.classList.add("active");l.scrollIntoView({block:"center"})}else"Enter"===t&&(e.preventDefault(),countryInput.value=l.innerText,countryListEl.classList.add("list-modal"))});let toggleDemoForm=document.getElementById("toggle-demo-checkbox");toggleDemoForm.addEventListener("change",e=>{e.target.checked?(document.querySelector(".filter-wrapper").style.display="block",document.getElementById("job-filter-popup").classList.add("visible")):(document.querySelector(".filter-wrapper").style.display="none",document.getElementById("job-filter-popup").classList.remove("visible"))});let closeWidgetPopup=document.getElementById("close-popup-widget");closeWidgetPopup.addEventListener("click",()=>{document.querySelector(".filter-wrapper").style.display="none",document.getElementById("job-filter-popup").classList.remove("visible")}),document.getElementById("close-popup-widget").addEventListener("click",()=>{document.getElementById("toggle-demo-checkbox").click()});
