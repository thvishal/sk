import{checkDisabledBtn as e,createList as t,createListCurrency as l,createSalaryTemplate as a,filterList as r,commaSeprateVal as n}from"https://cdn.jsdelivr.net/gh/thvishal/sk/widget-helper-min.js";let currencyList=[{label:"USD",value:"USD"},{label:"GBP",value:"GBP"},{label:"EUR",value:"EUR"},],url="https://cost-calculator.skuad.io/cost-calculator/active-country-list?enabled=true",fetchCountryData=async e=>{let t=await fetch(e),l=await t.json(),a=l.data.filter(e=>e.label&&e.enabled);return a},countryList=await fetchCountryData("https://cost-calculator.skuad.io/cost-calculator/active-country-list?enabled=true"),countryListWithCurrency=countryList;t(currencyList,"currency-list"),l(currencyList,"currency-input");let baseUrl="https://cost-calculator.skuad.io/cost-calculator/cost",endpoint="https://cost-calculator.skuad.io/cost-calculator/cost?client=website&countryCode=:countryCode&currencyCode=:currencyCode&salary=:salary&isExpat=:isExpat&provinceCode=:provinceCode",countryDownArrow=document.getElementById("show-calc-country"),form=document.getElementById("form"),countryInput=document.getElementById("country-input");countryInput.value="Loading...",countryInput.setAttribute("disabled","");let currencyInput=document.getElementById("currency-input"),currencyListEl=document.getElementById("currency-list"),countryListEl=document.getElementById("country-list"),grossSalaryInput=document.getElementById("gross-salary-input"),downloadPDFElement=document.getElementById("resp-download-pdf"),getCountryForError=document.querySelector(".error-msg-heading"),calculateBtn=document.getElementById("calculate-salary");grossSalaryInput.value=5e4;let currencyCurSelect=(e,t)=>{let a=countryListWithCurrency.find(t=>t.label===e);if(!a)return;let r=currencyList.filter((e,t)=>e.value!==a.currValue&&t<3),n=currencyList.find(e=>e.value===a.currValue);if(n&&!t){l(currencyList=currencyList.slice(0,3),"currency-input");return}(currencyList=r).push({label:a.currValue,value:a.currValue}),l(currencyList,"currency-input")};fetch("https://api.geoapify.com/v1/ipinfo?&apiKey=c23115da6cf642e59b96f32b9d512a4c",{crossDomain:!0,headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},method:"GET"}).then(e=>e.json()).then(e=>{countryInput.value="",currencyList.push({label:"",value:""})}).catch().finally(()=>{let e=document.getElementById("current-country");document.getElementById("c-country-name").innerText=e.innerText,document.getElementById("current-country-2").innerText=e.innerText;let t=countryList.find(t=>t.label===e.innerText);t.label===e.innerText&&(countryInput.removeAttribute("disabled"),countryInput.value=t.label,currencyCurSelect(t.label,!0)),"India"===countryInput.value&&(document.getElementById("is-expact").style.display="flex"),_handleSubmit()});let toggleMonthYear=document.getElementById("toggle-year-month"),yearlyRadio=document.getElementById("calc-yearly"),comData=null,salaryData=(e="monthly")=>{let t=comData[e];if(!t)return;let l=comData.categories,r=l.map(t=>{let l=t.subCategories.filter(t=>t.localAmounts[`${e}Value`]&&t.visibility).map(t=>({...t,value:t.localAmounts[`${e}Value`]}));return{...t,value:t.localAmounts[`${e}Value`],subCategories:l,categoryKey:t.key,currency:comData.currency}}),n=r.filter(e=>e.visibility&&e.value),c=n.filter(e=>e.categoryKey.includes("employer")||"skuadFee"===e.categoryKey||"skuadFeeDiscount"===e.categoryKey),o=n.filter(e=>e.categoryKey.includes("employee")),s=n.find(e=>"grossSalary"===e.categoryKey),u=[{label:"monthly"===e?"Monthly":"Yearly",data:c,grossSalaryTitle:`Gross ${"yearly"===e?"annual":"monthly"} pay`,totalEmploymentCost:comData.totalEmploymentCost.localAmounts[`${e}Value`],currency:comData.currency,grossSalary:s.localAmounts[`${e}Value`],durationHeading:`Total ${"yearly"===e?"annual":"monthly"} cost of employment`},{label:"Amount employee gets",data:o,grossSalaryTitle:`Gross ${"yearly"===e?"annual":"monthly"} pay`,totalEmploymentCost:comData.totalEmployeeSalary.localAmounts[`${e}Value`],currency:comData.currency,grossSalary:s.localAmounts[`${e}Value`],durationHeading:`Net ${"yearly"===e?"annual":"monthly"} salary`},];a(u)};function showModalHandler(){document.getElementById("show-calculator-modal").style.display="block"}function isFormSubmitedHandler(){salaryWidget=!0,hmshowExitPopup()}grossSalaryInput.addEventListener("keyup",t=>{grossSalaryInput.value=n(grossSalaryInput.value),e()});let _handleSubmit=async e=>{let t=JSON.parse(localStorage.getItem("salaryPopup"));e&&(t||isFormSubmitedHandler(),e.preventDefault()),calculateBtn.setAttribute("disabled","");let l=countryList.find(e=>e.label===countryInput.value);if(!l)return;let a=currencyList.find(e=>e.label===currencyInput.value),r=await fetch("https://cost-calculator.skuad.io/cost-calculator/cost?client=website&countryCode=:countryCode&currencyCode=:currencyCode&salary=:salary&isExpat=:isExpat&provinceCode=:provinceCode".replace(":countryCode",l.value).replace(":salary",grossSalaryInput.value.replaceAll(",","")).replace(":currencyCode",a.value));r.json().then(e=>{e.success?(comData=e.data,getCountryForError.innerText=`Want a detailed breakdown for cost of employment in ${l.label}`,downloadPDFElement.style.display="flex",document.getElementById("err-msg").style.display="none",comData.currency=a.value,salaryData(),showModalHandler(),document.getElementById("c-country-name").innerText=l.label,document.getElementById("current-country-2").innerText=l.label,document.getElementById("salary-wedget-loading").style.display="none"):(document.getElementById("err-msg").style.display="block",document.getElementById("show-calculator-modal").style.display="none",getCountryForError.innerText=`Want a detailed breakdown for cost of employment in ${countryInput.value}`),document.getElementById("calculate-salary").removeAttribute("disabled"),document.getElementById("calculate-salary").innerText="Calculate",document.getElementById("calc-selected-country").innerText=`Cost Breakdown - ${l.label}`}).catch(e=>{document.getElementById("calculate-salary").removeAttribute("disabled"),document.getElementById("calculate-salary").innerText="Calculate"})};form.onsubmit=_handleSubmit,toggleMonthYear.addEventListener("change",e=>{e.target.parentElement.parentElement.nextElementSibling.classList.remove("active"),e.target.parentElement.parentElement.previousElementSibling.classList.remove("active"),e.target.checked&&(salaryData("yearly"),e.target.parentElement.parentElement.nextElementSibling.classList.add("active")),!1===e.target.checked&&(salaryData("monthly"),e.target.parentElement.parentElement.previousElementSibling.classList.add("active"))});let toggleCountryList=t=>{if(t){t.stopPropagation(),t.target.value&&(t.target.value="");countryListEl.classList.toggle("list-modal"),currencyListEl.classList.add("list-modal"),r(countryList,"","country-list"),e()}else countryListEl.classList.remove("list-modal")};countryDownArrow.addEventListener("click",toggleCountryList),countryInput.addEventListener("click",toggleCountryList),countryInput.addEventListener("blur",e=>{let t=e.target.value,l=countryList.find(e=>e.label.toLowerCase()===t.toLowerCase());l||(countryInput.value="")});let countryListElOnClick=t=>{t.preventDefault(),"Item not found"!==t.target.innerText&&"UL"!==t.target.nodeName&&(countryInput.value=t.target.innerText,currencyCurSelect(t.target.innerText),toggleCountryList(t),l(currencyList,"currency-input"),e())};countryListEl.addEventListener("click",countryListElOnClick),countryInput.addEventListener("input",e=>{let t=e.target.value;r(countryList,t,"country-list"),toggleCountryList()}),document.body.addEventListener("click",()=>{let e=document.querySelectorAll(".list-cotainer");e.forEach(e=>e.classList.add("list-modal"))}),countryInput.addEventListener("keydown",e=>{let t=e.key,l=countryListEl.querySelector(".active");if("ArrowDown"===t){let a=countryListEl.firstChild;if("Item not found"===a.innerText)return;if(l){let r=l.nextSibling;l.classList.remove("active"),r.classList.add("active")}else a.classList.add("active");l.scrollIntoView({block:"center"})}else if("ArrowUp"===t){let n=countryListEl.lastChild;if(l){let c=l.previousSibling;l.classList.remove("active"),c.classList.add("active")}else n.classList.add("active");l.scrollIntoView({block:"center"})}else"Enter"===t&&(e.preventDefault(),countryInput.value=l.innerText,countryListEl.classList.add("list-modal"))});
